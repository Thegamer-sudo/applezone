---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getAllIphones, formatPrice } from '../data/iphones.js';

const allIphones = getAllIphones();
---

<BaseLayout>
    <section class="pt-24 pb-16 px-6">
        <div class="container mx-auto max-w-6xl">
            <!-- Page Header -->
            <div class="text-center mb-16">
                <h1 class="text-4xl font-semibold text-gray-900 mb-4">All iPhone Models</h1>
                <p class="text-gray-600 text-lg max-w-2xl mx-auto">
                    Browse our complete collection of premium iPhones, from XR to the latest 17 Pro Max
                </p>
            </div>

            <!-- Products Grid -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
                {allIphones.map(iphone => {
                    const hasImage = iphone.image && iphone.image.startsWith('/images/');
                    
                    return (
                        <a 
                            href={`/products/${iphone.id}`}
                            class="group bg-white rounded-2xl shadow-card hover:shadow-card-hover transition-all p-8 hover:scale-[1.02]"
                        >
                            <div class="flex justify-center mb-6">
                                {hasImage ? (
                                    <!-- Real iPhone Image -->
                                    <div class="w-44 h-44 bg-gray-100 rounded-xl flex items-center justify-center overflow-hidden p-4">
                                        <img 
                                            src={iphone.image} 
                                            alt={iphone.name}
                                            class="w-full h-full object-contain group-hover:scale-105 transition-transform duration-300"
                                            loading="lazy"
                                        />
                                    </div>
                                ) : (
                                    <!-- Placeholder -->
                                    <div class="w-44 h-44 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl flex items-center justify-center p-4">
                                        <div class="text-center">
                                            <div class="text-3xl font-bold text-gray-800">{iphone.name.split(' ')[1]}</div>
                                            <div class="text-sm text-gray-500 mt-1">{iphone.name.split(' ')[0]}</div>
                                        </div>
                                    </div>
                                )}
                            </div>
                            <div class="text-center">
                                <h3 class="text-xl font-semibold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors">{iphone.name}</h3>
                                <p class="text-gray-600 text-sm mb-4">{iphone.tagline}</p>
                                <div class="text-2xl font-bold text-gray-900">From {formatPrice(iphone.startingPrice)}</div>
                                
                                {/* Variants summary */}
                                <div class="mt-6 pt-6 border-t border-gray-100">
                                    <div class="flex justify-between text-sm text-gray-500">
                                        <span>Available:</span>
                                        <span class="font-medium text-gray-700">
                                            {iphone.variants.length} variant{iphone.variants.length !== 1 ? 's' : ''}
                                        </span>
                                    </div>
                                    <div class="flex justify-between text-sm text-gray-500 mt-2">
                                        <span>Colors:</span>
                                        <span class="font-medium text-gray-700">
                                            {iphone.colors.length}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </a>
                    );
                })}
            </div>

            <!-- Help Section -->
            <div class="mt-20 pt-12 border-t border-gray-200">
                <div class="text-center">
                    <h3 class="text-2xl font-semibold text-gray-900 mb-6">Need Help Choosing?</h3>
                    <a 
                        href="https://wa.me/27796353542"
                        target="_blank"
                        class="inline-flex items-center justify-center bg-gray-100 border border-gray-300 text-gray-700 font-medium px-8 py-4 rounded-xl hover:bg-gray-200 transition-colors"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-3">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
                        </svg>
                        Get Expert Advice on WhatsApp
                    </a>
                </div>
            </div>
        </div>
    </section>
</BaseLayout>